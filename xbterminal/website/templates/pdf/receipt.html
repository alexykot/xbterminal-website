{% load i18n website_tags %}
<!DOCTYPE html>
<html>
<head>

<meta http-equiv="content-type" content="text/html; charset=utf-8"> 
<style type="text/css">
    @font-face {
        font-family: FontAwesome;
        src: url('{% pdf_static 'fonts/fontawesome-webfont.ttf' %}');
    }
    body {
        font-size: 16px;
    }
    @page {
        margin: 1cm;
        margin-top: 3cm;
        @frame qrcode-text {
            -pdf-frame-content: qrcode-text;
            width: 12cm;
            bottom: 5cm;
            height: 2.5cm;
            right: 6cm;
        }
        @frame qrcode {
            -pdf-frame-content: qrcode;
            width: 5cm;
            bottom: 5cm;
            height: 5cm;
            right: 0cm;
        }
        @frame footer {
            -pdf-frame-content: footer;
            bottom: 0.25cm;
            text-align: center;
            height: 2cm;
            left: 6cm;
            vertical-align: middle;
        }
        @frame footer-image {
            -pdf-frame-content: footer-image;
            bottom: 0cm;
            height: 2.5cm;
            left: 9cm;
        }
    }
    #qrcode-text {
        font-size: 14px;
        color: #555;
    }
    #footer {
        color: #777;
    }
    .title {
        text-align: center;
        font-weight: bold;
        font-size: 20px;
    }
    .btc-symbol {
        font-family: FontAwesome;
    }
    table {
        margin-top: 30px;
        color: #555;
        border: 1px;
    }
    td, th {
        padding: 5px;
        padding-bottom: 0px;
    }
    .col1 {
        text-align: right;
    }
    .external-link {
        font-size: 13px;
    }
</style>
</head>
<body>
<div class="title">
    {% if order.order_type == 'payment' %}{% trans 'Customer Receipt' %}
    {% elif order.order_type == 'withdrawal' %}{% trans 'Withdrawal Receipt' %}
    {% endif %} - #{{ order.id }}
</div>
<table>
    <tr>
        <td style="width: 400px;" class="col1">{% trans 'Amount' %}</td>
        <td class="col2">{{ order.merchant.currency.prefix }}{{ order.fiat_amount|floatformat:2 }}{{ order.merchant.currency.postfix }}</td>
    </tr>
    <tr>
        <td class="col1">
            {% if order.order_type == 'payment' %}{% trans 'Bitcoin amount paid' %}
            {% elif order.order_type == 'withdrawal' %}{% trans 'Bitcoin amount withdrawn' %}
            {% endif %}
        </td>
        <td class="col2 btc-amount">m<span class="btc-symbol">&#xf15a;</span> {{ order.btc_amount|scale|floatformat:5 }}</td>
    </tr>
    {% if order.order_type == 'withdrawal' %}
    <tr>
        <td class="col1">{% trans 'Network fee' %}</td>
        <td class="col2 btc-amount">m<span class="btc-symbol">&#xf15a;</span> {{ order.tx_fee_btc_amount|scale|floatformat:5 }}</td>
    </tr>
    {% endif %}
    <tr>
        <td class="col1">{% trans 'Effective exchange rate' %}</td>
        <td class="col2">{{ order.merchant.currency.prefix }}{{ order.effective_exchange_rate|unscale|floatformat:4 }}{{ order.merchant.currency.postfix }}</td>
    </tr>
    <tr></tr>
    <tr>
        <td class="col1">{% trans 'Destination address' %}</td>
        {% if order.order_type == 'payment' %}
        <td class="col2">
            <a class="external-link" href="{% btc_address_url order.local_address order.bitcoin_network %}">
                {{ order.local_address }}
            </a>
        </td>
        {% elif order.order_type == 'withdrawal' %}
        <td class="col2">
            <a class="external-link" href="{% btc_address_url order.customer_address order.bitcoin_network %}">
                {{ order.customer_address }}
            </a>
        </td>
        {% endif %}
    </tr>
    <tr>
        <td class="col1">{% trans 'Bitcoin transaction ID' %}</td>
        {% if order.order_type == 'payment' %}
        <td class="col2">
            {% for incoming_tx_id in order.incoming_tx_ids %}
            <a class="external-link" href="{% btc_tx_url incoming_tx_id order.bitcoin_network %}">
                {{ incoming_tx_id }}
            </a>
            {% endfor %}
        </td>
        {% elif order.order_type == 'withdrawal' %}
        <td class="col2">
            <a class="external-link" href="{% btc_tx_url order.outgoing_tx_id order.bitcoin_network %}">
                {{ order.outgoing_tx_id }}
            </a>
        </td>
        {% endif %}
    </tr>
    <tr></tr>
    <tr>
        <td class="col1">{% trans 'Merchant name' %}</td>
        <td class="col2">{{ order.merchant.company_name }}</td>
    </tr>
    <tr>
        <td class="col1">{% trans 'Merchant address' %}</td>
        <td class="col2">{{ order.merchant.billing_address|join:', ' }}</td>
    </tr>
    <tr>
        <td class="col1">{% trans 'Receipt number' %}</td>
        <td class="col2">{{ order.id }}</td>
    </tr>
    <tr>
        <td class="col1">{% trans 'Transaction time' %}</td>
        <td class="col2">
            {% language 'en' %}
            {{ order.time_notified|date:'d M Y, h:i A' }}
            {% endlanguage %}
        </td>
    </tr>
</table>
<div id="qrcode-text">
    <div><a href="{{ order.receipt_url }}">{{ order.receipt_url }}</a></div>
    <div>{% trans 'View this receipt online by visiting the link above, or by scanning the QR code adjacent.' %}</div>
</div>
<div id="qrcode">
    {% qr_from_text order.receipt_url 4 %}
</div>
<div id="footer">{% trans 'processed by' %}</div>
<div id="footer-image"><img src="{% pdf_static 'img/xbt_logo_small.png' %}"></div>
</body>
</html>
